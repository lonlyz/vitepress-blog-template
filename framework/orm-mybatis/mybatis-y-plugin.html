<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MyBatis详解 - 插件机制 | 知识星球</title>
    <meta name="description" content="不积硅步，无以至千里。">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/vitepress-blog-template/assets/style.hz1UbIDt.css" as="style">
    <link rel="preload stylesheet" href="/vitepress-blog-template/vp-icons.css" as="style">
    <script type="module" src="/vitepress-blog-template/assets/chunks/metadata.079420e9.js"></script>
    <script type="module" src="/vitepress-blog-template/assets/app.D1P0Vk3Q.js"></script>
    <link rel="preload" href="/vitepress-blog-template/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/vitepress-blog-template/assets/chunks/theme.FAufiNZT.js">
    <link rel="modulepreload" href="/vitepress-blog-template/assets/chunks/framework.BrYByd3F.js">
    <link rel="modulepreload" href="/vitepress-blog-template/assets/framework_orm-mybatis_mybatis-y-plugin.md.C9S8HKDM.lean.js">
    <link rel="icon" type="image/svg+xml" href="/vitepress-blog-template/vitepress-logo-mini.svg">
    <link rel="icon" type="image/png" href="/vitepress-blog-template/vitepress-logo-mini.png">
    <meta name="theme-color" content="#5f67ee">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/vitepress-blog-template/" data-v-1168a8e4><!--[--><!--]--><!--[--><img class="VPImage logo" src="/vitepress-blog-template/vitepress-logo-mini.svg" width="24" height="24" alt data-v-8426fc1a><!--]--><span data-v-1168a8e4>知识星球</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索文档"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">搜索文档</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/vitepress-blog-template/interview/x-interview" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>面试</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>Java</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>Java面向对象和基础</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/basic/java-basic-oop" data-v-35975db6><!--[--><span data-v-35975db6>java面向对象基础</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/basic/java-basic-lan-basic" data-v-35975db6><!--[--><span data-v-35975db6>java基础知识体系</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>Java进阶-集合框架</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/collection/java-collection-all" data-v-35975db6><!--[--><span data-v-35975db6>java集合框架详解</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>Java进阶-并发框架</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/thread/java-thread-x-overview" data-v-35975db6><!--[--><span data-v-35975db6>java并发知识体系</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/thread/java-thread-x-theorty" data-v-35975db6><!--[--><span data-v-35975db6>java并发理论基础</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/thread/java-thread-x-thread-basic" data-v-35975db6><!--[--><span data-v-35975db6>java线程理论基础</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/thread/java-thread-x-juc-overview" data-v-35975db6><!--[--><span data-v-35975db6>java J.U.C基础</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>Java进阶-IO框架</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/io/java-io-overview" data-v-35975db6><!--[--><span data-v-35975db6>Java IO/NIO/AIO详解</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>java进阶-新版本特性</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/java8/java8" data-v-35975db6><!--[--><span data-v-35975db6>java 8特性</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/java8up/java-8-up-overview" data-v-35975db6><!--[--><span data-v-35975db6>java 8以上版本特性</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/java8up/java9-11" data-v-35975db6><!--[--><span data-v-35975db6>java 8升级java 11</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/java8up/java12-17" data-v-35975db6><!--[--><span data-v-35975db6>java 11升级java 17</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>java进阶-JVM</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/jvm/java-jvm-classload" data-v-35975db6><!--[--><span data-v-35975db6>java类加载机制</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/jvm/java-jvm-class" data-v-35975db6><!--[--><span data-v-35975db6>java字节码和增强技术</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/jvm/java-jvm-struct" data-v-35975db6><!--[--><span data-v-35975db6>java内存结构</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/jvm/java-jvm-gc" data-v-35975db6><!--[--><span data-v-35975db6>java垃圾回收</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/java/jvm/java-jvm-debug-tools-linux" data-v-35975db6><!--[--><span data-v-35975db6>java调试排错</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>开发</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>开发 - 常用开发基础</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/develop/package/dev-package-x-overview" data-v-35975db6><!--[--><span data-v-35975db6>常用类库详解</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/develop/regex/dev-regex-all" data-v-35975db6><!--[--><span data-v-35975db6>正则表达式详解</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/develop/cron/dev-cron-x-usage" data-v-35975db6><!--[--><span data-v-35975db6>CRON表达式详解</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/develop/protocol/dev-protocol-overview" data-v-35975db6><!--[--><span data-v-35975db6>网络协议和工具详解</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/develop/security/dev-security-overview" data-v-35975db6><!--[--><span data-v-35975db6>安全相关详解</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>开发 - 质量保障</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/develop/ut/dev-ut-unit-test" data-v-35975db6><!--[--><span data-v-35975db6>单元测试详解</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/develop/ut/dev-qt-code-style" data-v-35975db6><!--[--><span data-v-35975db6>统一风格详解</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/develop/ut/dev-qt-sonarlint" data-v-35975db6><!--[--><span data-v-35975db6>质量管理详解</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>开发 - 代码重构</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/develop/refactor/dev-refactor-if-else" data-v-35975db6><!--[--><span data-v-35975db6>代码重构相关</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>spring</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>Spring Framework(v5.3)</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/spring" data-v-35975db6><!--[--><span data-v-35975db6>Spring框架知识体系</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/spring-x-framework-introduce" data-v-35975db6><!--[--><span data-v-35975db6>Spring框架组成</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/spring-x-framework-ioc" data-v-35975db6><!--[--><span data-v-35975db6>控制反转(IOC)</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/spring-x-framework-aop" data-v-35975db6><!--[--><span data-v-35975db6>面向切面编程(AOP)</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/spring-x-framework-springmvc" data-v-35975db6><!--[--><span data-v-35975db6>SpringMVC</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>SpringBoot系列(v2.5)</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/springboot/springboot" data-v-35975db6><!--[--><span data-v-35975db6>SpringBoot知识体系</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/springboot/springboot-x-hello-world" data-v-35975db6><!--[--><span data-v-35975db6>SpringBoot入门</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/springboot/springboot-x-interface-response" data-v-35975db6><!--[--><span data-v-35975db6>SpringBoot接口设计和实现</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/springboot/springboot-x-mysql-jpa" data-v-35975db6><!--[--><span data-v-35975db6>SpringBoot集成MySQL</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/springboot/springboot-x-mysql-shardingjdbc" data-v-35975db6><!--[--><span data-v-35975db6>SpringBoot集成ShardingJDBC</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/springboot/springboot-x-redis-jedis" data-v-35975db6><!--[--><span data-v-35975db6>SpringBoot集成Redis</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/springboot/springboot-x-postgre-jpa" data-v-35975db6><!--[--><span data-v-35975db6>SpringBoot集成Postgre</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/springboot/springboot-x-elastic-template" data-v-35975db6><!--[--><span data-v-35975db6>SpringBoot集成ElasticSearch</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/springboot/springboot-x-socket-websocket" data-v-35975db6><!--[--><span data-v-35975db6>SpringBoot集成Socket</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/springboot/springboot-x-task-timer" data-v-35975db6><!--[--><span data-v-35975db6>SpringBoot定时任务</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/springboot/springboot-x-view-thymeleaf" data-v-35975db6><!--[--><span data-v-35975db6>SpringBoot后端视图</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/springboot/springboot-x-monitor-actuator" data-v-35975db6><!--[--><span data-v-35975db6>SpringBoot监控</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/spring/springboot/springboot-y-auo-config" data-v-35975db6><!--[--><span data-v-35975db6>SpringBoot进阶</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>数据库</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>数据库基础和原理</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/db/sql/sql-db" data-v-35975db6><!--[--><span data-v-35975db6>数据库原理</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/db/sql-lan/sql-lan" data-v-35975db6><!--[--><span data-v-35975db6>SQL语言</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>SQL 数据库</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/db/sql-mysql/sql-mysql-overview" data-v-35975db6><!--[--><span data-v-35975db6>MySQL 详解</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>NoSQL 数据库</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/db/nosql-redis/db-redis-overview" data-v-35975db6><!--[--><span data-v-35975db6>Redis 详解</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/db/nosql-mongo/mongo" data-v-35975db6><!--[--><span data-v-35975db6>MongoDB 详解</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/db/nosql-es/elasticsearch" data-v-35975db6><!--[--><span data-v-35975db6>ElasticSearch 详解</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>算法</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>算法基础和思想</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/algorithm/alg-basic-overview" data-v-35975db6><!--[--><span data-v-35975db6>数据结构基础</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/algorithm/alg-sort-overview" data-v-35975db6><!--[--><span data-v-35975db6>常见排序算法</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/algorithm/alg-core-divide-and-conquer" data-v-35975db6><!--[--><span data-v-35975db6>算法思想</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>一些领域算法</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/algorithm/alg-domain-security-degist" data-v-35975db6><!--[--><span data-v-35975db6>安全算法</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/algorithm/alg-domain-char-match" data-v-35975db6><!--[--><span data-v-35975db6>字符串匹配算法</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/algorithm/alg-domain-distribute-overview" data-v-35975db6><!--[--><span data-v-35975db6>分布式系统算法</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/algorithm/alg-domain-bigdata-overview" data-v-35975db6><!--[--><span data-v-35975db6>海量数据处理</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/algorithm/alg-domain-load-balance" data-v-35975db6><!--[--><span data-v-35975db6>负载均衡算法</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/algorithm/alg-domain-suggest" data-v-35975db6><!--[--><span data-v-35975db6>推荐算法</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/algorithm/alg-domain-machine" data-v-35975db6><!--[--><span data-v-35975db6>数据挖掘算法</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/algorithm/alg-domain-id-snowflake" data-v-35975db6><!--[--><span data-v-35975db6>ID生成算法</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>其它算法相关</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/algorithm/alg-other-mind" data-v-35975db6><!--[--><span data-v-35975db6>头脑风暴</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>框架|中间件</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>Web 容器</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/framework/tomcat/tomcat-overview" data-v-35975db6><!--[--><span data-v-35975db6>Tomcat 源码详解</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>ORM 框架</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-overview" data-v-35975db6><!--[--><span data-v-35975db6>MyBatis 源码详解</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>分表分库框架</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/framework/ds-sharding/sharding-overview" data-v-35975db6><!--[--><span data-v-35975db6>ShardingSphere 详解</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>消息队列框架</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/framework/kafka/kafka" data-v-35975db6><!--[--><span data-v-35975db6>kafka 详解</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>架构</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>架构基础和技术点</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/basic/arch-x-overview" data-v-35975db6><!--[--><span data-v-35975db6>架构知识体系</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/basic/arch-x-view" data-v-35975db6><!--[--><span data-v-35975db6>从角色视角看架构</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/basic/arch-x-view-2" data-v-35975db6><!--[--><span data-v-35975db6>从分层视角看架构</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/basic/arch-x-evolution" data-v-35975db6><!--[--><span data-v-35975db6>从演化视角看架构</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/basic/arch-x-pattern" data-v-35975db6><!--[--><span data-v-35975db6>从模式视角看架构</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/basic/arch-y-cache" data-v-35975db6><!--[--><span data-v-35975db6>高并发之缓存</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/basic/arch-y-ratelimit" data-v-35975db6><!--[--><span data-v-35975db6>高并发之限流</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/basic/arch-y-reduce" data-v-35975db6><!--[--><span data-v-35975db6>高并发之降级和熔断</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/basic/arch-y-loadbalance" data-v-35975db6><!--[--><span data-v-35975db6>高可用之负载均衡</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/basic/arch-y-backup" data-v-35975db6><!--[--><span data-v-35975db6>高可用之容灾备份</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>分布式系统</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/distribute/arch-z-theory" data-v-35975db6><!--[--><span data-v-35975db6>分布式理论和一致性算法</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/distribute/arch-z-id" data-v-35975db6><!--[--><span data-v-35975db6>全局唯一ID实现方案</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/distribute/arch-z-lock" data-v-35975db6><!--[--><span data-v-35975db6>分布式锁及实现方案</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/distribute/arch-z-transection" data-v-35975db6><!--[--><span data-v-35975db6>分布式事务及实现方案</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/distribute/arch-z-job" data-v-35975db6><!--[--><span data-v-35975db6>分布式任务及实现方案</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/distribute/arch-z-session" data-v-35975db6><!--[--><span data-v-35975db6>分布式会话及实现方案</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>微服务系统</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/microservice/arch-m-singleton-2" data-v-35975db6><!--[--><span data-v-35975db6>微服务系统和设计</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>系统设计之商业业务平台</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/business/arch-example-seckill" data-v-35975db6><!--[--><span data-v-35975db6>秒杀抽奖相关设计</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/business/arch-example-goods-detail" data-v-35975db6><!--[--><span data-v-35975db6>电商交易相关设计</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/business/arch-example-meituan-jishiwuliu" data-v-35975db6><!--[--><span data-v-35975db6>仓储物流相关设计</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/business/arch-example-xianyu-laxintoufang" data-v-35975db6><!--[--><span data-v-35975db6>拉新投放相关设计</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/business/arch-example-meituan-waimai" data-v-35975db6><!--[--><span data-v-35975db6>其它综合相关设计</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-b98bc113 data-v-69e747b5><p class="title" data-v-69e747b5>系统设计之数据仓库平台</p><!--[--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/datahouse/arch-example-meituan-db-hp" data-v-35975db6><!--[--><span data-v-35975db6>数据库架构相关设计</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/datahouse/arch-example-meituan-db-binlog" data-v-35975db6><!--[--><span data-v-35975db6>数据同步相关设计</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/datahouse/arch-example-meituan-data-cangchu" data-v-35975db6><!--[--><span data-v-35975db6>数据仓库相关设计</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-69e747b5 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/arch/datahouse/arch-example-meituan-data-zhili" data-v-35975db6><!--[--><span data-v-35975db6>数据治理相关设计</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>工具|部署</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/tool/tool-list-overview" data-v-35975db6><!--[--><span data-v-35975db6> 工具清单  </span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/tool/tool-git" data-v-35975db6><!--[--><span data-v-35975db6> 开发工具详解  </span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/tool/linux" data-v-35975db6><!--[--><span data-v-35975db6> Linux  </span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-b98bc113 data-v-35975db6><a class="VPLink link" href="/vitepress-blog-template/tool/docker-00-overview" data-v-35975db6><!--[--><span data-v-35975db6> 容器化 - Docker  </span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>主题</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>菜单</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-8a42e2b4><button data-v-8a42e2b4>回到顶部</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b3fd67f8><!----><div class="items" data-v-b3fd67f8><!--[--><section class="VPSidebarItem level-1 collapsible" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h3 class="text" data-v-b3fd67f8>Web容器 - Tomcat知识体系详解 </h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b3fd67f8><span class="vpi-chevron-right caret-icon" data-v-b3fd67f8></span></div></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-overview" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> ♥Tomcat源码详解知识体系详解♥ </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-design-web-container" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - 如何设计一个简单的web容器 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-arch" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - 理解Tomcat架构设计 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-sourcecode" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - 源码分析准备和分析入口 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-start" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - 启动过程：初始化和启动流程 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-classloader" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - 启动过程:类加载机制详解 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-catalina" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - 启动过程:Catalina的加载 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-lifecycle" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - 组件生命周期管理:LifeCycle </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-jmx" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - 组件拓展管理:JMX和MBean </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-listener" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - 事件的监听机制：观察者模式 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-server" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - Server的设计和实现: StandardServer </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-service" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - Service的设计和实现: StandardService </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-executor" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - 线程池的设计与实现：StandardThreadExecutor </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-container" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - Request请求处理: Container设计 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-container-engine" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - Container容器之Engine：StandardEngine </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-container-pipline" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - Container的管道机制：责任链模式 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/tomcat/tomcat-x-connector" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> Tomcat - Request请求处理过程：Connector </p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 has-active" data-v-c40bc020 data-v-b3fd67f8><!----><div class="items" data-v-b3fd67f8><!--[--><section class="VPSidebarItem level-1 collapsible has-active" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h3 class="text" data-v-b3fd67f8>ORM框架 - MyBatis知识体系详解 </h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b3fd67f8><span class="vpi-chevron-right caret-icon" data-v-b3fd67f8></span></div></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-overview" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> ♥MyBatis知识体系详解♥ </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-arch" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> MyBatis详解 - 总体框架设计 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-init" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> MyBatis详解 - 初始化基本过程 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-config-load" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> MyBatis详解 - 配置解析过程 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-config-list" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> MyBatis详解 - 官网配置清单 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-config-mapper" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> MyBatis详解 - Mapper映射文件配置 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-sql-exec" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> MyBatis详解 - sqlSession执行流程 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-dynamic-sql" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> MyBatis详解 - 动态SQL使用与原理 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-plugin" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> MyBatis详解 - 插件机制 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-plugin-page" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> MyBatis详解 - 插件之分页机制 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-datasource" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> MyBatis详解 - 数据源与连接池 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-trans" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> MyBatis详解 - 事务管理机制 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-cache-level1" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> MyBatis详解 - 一级缓存实现机制 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-cache-level2" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> MyBatis详解 - 二级缓存实现机制 </p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b3fd67f8><!----><div class="items" data-v-b3fd67f8><!--[--><section class="VPSidebarItem level-1 collapsible" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h3 class="text" data-v-b3fd67f8>分表分库 - ShardingSphere详解 </h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b3fd67f8><span class="vpi-chevron-right caret-icon" data-v-b3fd67f8></span></div></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/ds-sharding/sharding-overview" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> ♥ShardingSphere详解知识体系♥ </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/ds-sharding/sharding-x-arch" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> ShardingSphere详解 - 整体架构设计 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/ds-sharding/sharding-x-shard" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> ShardingSphere详解 - 数据分片的原理 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/ds-sharding/sharding-x-encrypt" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> ShardingSpherex详解 - 数据脱敏(加密)详解 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/ds-sharding/sharding-x-trans-xa" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> ShardingSphere详解 - 事务实现原理之两阶段事务XA </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/ds-sharding/sharding-x-trans-saga" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> ShardingSphere详解 - 事务实现原理之柔性事务SAGA </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/ds-sharding/sharding-x-trans-seata" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> ShardingSphere详解 - 事务实现原理之柔性事务SEATA </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/ds-sharding/sharding-x-scale" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> ShardingSphere详解 - 弹性伸缩原理 </p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/ds-sharding/sharding-x-shadow" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8> ShardingSphere详解 - 通过影子库进行压测 </p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0" data-v-c40bc020 data-v-b3fd67f8><!----><div class="items" data-v-b3fd67f8><!--[--><section class="VPSidebarItem level-1 collapsible" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" role="button" tabindex="0" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><h3 class="text" data-v-b3fd67f8>消息队列 - Kafka知识体系详解 </h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b3fd67f8><span class="vpi-chevron-right caret-icon" data-v-b3fd67f8></span></div></div><div class="items" data-v-b3fd67f8><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b3fd67f8 data-v-b3fd67f8><div class="item" data-v-b3fd67f8><div class="indicator" data-v-b3fd67f8></div><a class="VPLink link link" href="/vitepress-blog-template/framework/kafka/kafka" data-v-b3fd67f8><!--[--><p class="text" data-v-b3fd67f8>kafka详解</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>目录</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _vitepress-blog-template_framework_orm-mybatis_mybatis-y-plugin" data-v-39a288b8><div><h1 id="mybatis详解-插件机制" tabindex="-1">MyBatis详解 - 插件机制 <a class="header-anchor" href="#mybatis详解-插件机制" aria-label="Permalink to &quot;MyBatis详解 - 插件机制&quot;">​</a></h1><blockquote><p>MyBatis提供了一种插件(plugin)的功能，虽然叫做插件，但其实这是拦截器功能。那么拦截器拦截MyBatis中的哪些内容呢？@pdai</p></blockquote><h2 id="概述" tabindex="-1">概述 <a class="header-anchor" href="#概述" aria-label="Permalink to &quot;概述&quot;">​</a></h2><p>MyBatis 允许你在已映射语句执行过程中的某一点进行拦截调用。默认情况下，MyBatis允许使用插件来拦截的方法调用包括：</p><ul><li>Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed) 拦截执行器的方法</li><li>ParameterHandler (getParameterObject, setParameters) 拦截参数的处理</li><li>ResultSetHandler (handleResultSets, handleOutputParameters) 拦截结果集的处理</li><li>StatementHandler (prepare, parameterize, batch, update, query) 拦截Sql语法构建的处理</li></ul><p>Mybatis采用责任链模式，通过动态代理组织多个拦截器（插件），通过这些拦截器可以改变Mybatis的默认行为（诸如SQL重写之类的），由于插件会深入到Mybatis的核心，因此在编写自己的插件前最好了解下它的原理，以便写出安全高效的插件。</p><h2 id="拦截器的使用" tabindex="-1">拦截器的使用 <a class="header-anchor" href="#拦截器的使用" aria-label="Permalink to &quot;拦截器的使用&quot;">​</a></h2><h3 id="拦截器介绍及配置" tabindex="-1">拦截器介绍及配置 <a class="header-anchor" href="#拦截器介绍及配置" aria-label="Permalink to &quot;拦截器介绍及配置&quot;">​</a></h3><p>首先我们看下MyBatis拦截器的接口定义：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>public interface Interceptor {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Object intercept(Invocation invocation) throws Throwable;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Object plugin(Object target);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  void setProperties(Properties properties);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span></code></pre></div><p>比较简单，只有3个方法。 MyBatis默认没有一个拦截器接口的实现类，开发者们可以实现符合自己需求的拦截器。下面的MyBatis官网的一个拦截器实例：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>@Intercepts({@Signature(type= Executor.class, method = &quot;update&quot;, args = {MappedStatement.class,Object.class})})</span></span>
<span class="line"><span>public class ExamplePlugin implements Interceptor {</span></span>
<span class="line"><span>  public Object intercept(Invocation invocation) throws Throwable {</span></span>
<span class="line"><span>    return invocation.proceed();</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  public Object plugin(Object target) {</span></span>
<span class="line"><span>    return Plugin.wrap(target, this);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  public void setProperties(Properties properties) {</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>全局xml配置：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&lt;plugins&gt;</span></span>
<span class="line"><span>    &lt;plugin interceptor=&quot;org.format.mybatis.cache.interceptor.ExamplePlugin&quot;&gt;&lt;/plugin&gt;</span></span>
<span class="line"><span>&lt;/plugins&gt;</span></span></code></pre></div><p>这个拦截器拦截Executor接口的update方法（其实也就是SqlSession的新增，删除，修改操作），所有执行executor的update方法都会被该拦截器拦截到。</p><h3 id="源码分析" tabindex="-1">源码分析 <a class="header-anchor" href="#源码分析" aria-label="Permalink to &quot;源码分析&quot;">​</a></h3><p>首先从源头-&gt;配置文件开始分析：</p><p>XMLConfigBuilder解析MyBatis全局配置文件的pluginElement私有方法：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>private void pluginElement(XNode parent) throws Exception {</span></span>
<span class="line"><span>    if (parent != null) {</span></span>
<span class="line"><span>        for (XNode child : parent.getChildren()) {</span></span>
<span class="line"><span>            String interceptor = child.getStringAttribute(&quot;interceptor&quot;);</span></span>
<span class="line"><span>            Properties properties = child.getChildrenAsProperties();</span></span>
<span class="line"><span>            Interceptor interceptorInstance = (Interceptor) resolveClass(interceptor).newInstance();</span></span>
<span class="line"><span>            interceptorInstance.setProperties(properties);</span></span>
<span class="line"><span>            configuration.addInterceptor(interceptorInstance);</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>具体的解析代码其实比较简单，就不贴了，主要就是通过反射实例化plugin节点中的interceptor属性表示的类。然后调用全局配置类Configuration的addInterceptor方法。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>public void addInterceptor(Interceptor interceptor) {</span></span>
<span class="line"><span>    interceptorChain.addInterceptor(interceptor);</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>这个interceptorChain是Configuration的内部属性，类型为InterceptorChain，也就是一个拦截器链，我们来看下它的定义：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>public class InterceptorChain {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    private final List&lt;Interceptor&gt; interceptors = new ArrayList&lt;Interceptor&gt;();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    public Object pluginAll(Object target) {</span></span>
<span class="line"><span>        for (Interceptor interceptor : interceptors) {</span></span>
<span class="line"><span>            target = interceptor.plugin(target);</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>        return target;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    public void addInterceptor(Interceptor interceptor) {</span></span>
<span class="line"><span>        interceptors.add(interceptor);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    public List&lt;Interceptor&gt; getInterceptors() {</span></span>
<span class="line"><span>        return Collections.unmodifiableList(interceptors);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span></code></pre></div><p>现在我们理解了拦截器配置的解析以及拦截器的归属，现在我们回过头看下为何拦截器会拦截这些方法（Executor，ParameterHandler，ResultSetHandler，StatementHandler的部分方法）：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>public ParameterHandler newParameterHandler(MappedStatement mappedStatement, Object parameterObject, BoundSql boundSql) {</span></span>
<span class="line"><span>    ParameterHandler parameterHandler = mappedStatement.getLang().createParameterHandler(mappedStatement, parameterObject, boundSql);</span></span>
<span class="line"><span>    parameterHandler = (ParameterHandler) interceptorChain.pluginAll(parameterHandler);</span></span>
<span class="line"><span>    return parameterHandler;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>public ResultSetHandler newResultSetHandler(Executor executor, MappedStatement mappedStatement, RowBounds rowBounds, ParameterHandler parameterHandler, ResultHandler resultHandler, BoundSql boundSql) {</span></span>
<span class="line"><span>    ResultSetHandler resultSetHandler = new DefaultResultSetHandler(executor, mappedStatement, parameterHandler, resultHandler, boundSql, rowBounds);</span></span>
<span class="line"><span>    resultSetHandler = (ResultSetHandler) interceptorChain.pluginAll(resultSetHandler);</span></span>
<span class="line"><span>    return resultSetHandler;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>public StatementHandler newStatementHandler(Executor executor, MappedStatement mappedStatement, Object parameterObject, RowBounds rowBounds, ResultHandler resultHandler, BoundSql boundSql) {</span></span>
<span class="line"><span>    StatementHandler statementHandler = new RoutingStatementHandler(executor, mappedStatement, parameterObject, rowBounds, resultHandler, boundSql);</span></span>
<span class="line"><span>    statementHandler = (StatementHandler) interceptorChain.pluginAll(statementHandler);</span></span>
<span class="line"><span>    return statementHandler;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>public Executor newExecutor(Transaction transaction, ExecutorType executorType, boolean autoCommit) {</span></span>
<span class="line"><span>    executorType = executorType == null ? defaultExecutorType : executorType;</span></span>
<span class="line"><span>    executorType = executorType == null ? ExecutorType.SIMPLE : executorType;</span></span>
<span class="line"><span>    Executor executor;</span></span>
<span class="line"><span>    if (ExecutorType.BATCH == executorType) {</span></span>
<span class="line"><span>        executor = new BatchExecutor(this, transaction);</span></span>
<span class="line"><span>    } else if (ExecutorType.REUSE == executorType) {</span></span>
<span class="line"><span>        executor = new ReuseExecutor(this, transaction);</span></span>
<span class="line"><span>    } else {</span></span>
<span class="line"><span>        executor = new SimpleExecutor(this, transaction);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    if (cacheEnabled) {</span></span>
<span class="line"><span>        executor = new CachingExecutor(executor, autoCommit);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    executor = (Executor) interceptorChain.pluginAll(executor);</span></span>
<span class="line"><span>    return executor;</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>以上4个方法都是Configuration的方法。这些方法在MyBatis的一个操作(新增，删除，修改，查询)中都会被执行到，执行的先后顺序是Executor，ParameterHandler，ResultSetHandler，StatementHandler(其中ParameterHandler和ResultSetHandler的创建是在创建StatementHandler[3个可用的实现类CallableStatementHandler,PreparedStatementHandler,SimpleStatementHandler]的时候，其构造函数调用的[这3个实现类的构造函数其实都调用了父类BaseStatementHandler的构造函数])。</p><p>这4个方法实例化了对应的对象之后，都会调用interceptorChain的pluginAll方法，InterceptorChain的pluginAll刚才已经介绍过了，就是遍历所有的拦截器，然后调用各个拦截器的plugin方法。注意：拦截器的plugin方法的返回值会直接被赋值给原先的对象。</p><p>由于可以拦截StatementHandler，这个接口主要处理sql语法的构建，因此比如分页的功能，可以用拦截器实现，只需要在拦截器的plugin方法中处理StatementHandler接口实现类中的sql即可，可使用反射实现。</p><p>MyBatis还提供了@Intercepts和 @Signature关于拦截器的注解。官网的例子就是使用了这2个注解，还包括了Plugin类的使用：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>@Override</span></span>
<span class="line"><span>public Object plugin(Object target) {</span></span>
<span class="line"><span>    return Plugin.wrap(target, this);</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="代理链的生成" tabindex="-1">代理链的生成 <a class="header-anchor" href="#代理链的生成" aria-label="Permalink to &quot;代理链的生成&quot;">​</a></h2><blockquote><p>Mybatis支持对Executor、StatementHandler、ParameterHandler和ResultSetHandler进行拦截，也就是说会对这4种对象进行代理。通过查看Configuration类的源代码我们可以看到，每次都对目标对象进行代理链的生成。</p></blockquote><p>下面以Executor为例。Mybatis在创建Executor对象时会执行下面一行代码：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>executor =(Executor) interceptorChain.pluginAll(executor);</span></span></code></pre></div><p>InterceptorChain里保存了所有的拦截器，它在mybatis初始化的时候创建。上面这句代码的含义是调用拦截器链里的每个拦截器依次对executor进行plugin（插入？）代码如下：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span> /** </span></span>
<span class="line"><span>  * 每一个拦截器对目标类都进行一次代理 </span></span>
<span class="line"><span>  * @param target </span></span>
<span class="line"><span>  * @return 层层代理后的对象 </span></span>
<span class="line"><span>  */  </span></span>
<span class="line"><span> public Object pluginAll(Object target) {  </span></span>
<span class="line"><span>     for(Interceptor interceptor : interceptors) {  </span></span>
<span class="line"><span>         target= interceptor.plugin(target);  </span></span>
<span class="line"><span>     }  </span></span>
<span class="line"><span>     return target;  </span></span>
<span class="line"><span> }</span></span></code></pre></div><p>下面以一个简单的例子来看看这个plugin方法里到底发生了什么：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>@Intercepts({@Signature(type = Executor.class, method =&quot;update&quot;, args = {MappedStatement.class, Object.class})})  </span></span>
<span class="line"><span>public class ExamplePlugin implements Interceptor {  </span></span>
<span class="line"><span>    @Override  </span></span>
<span class="line"><span>    public Object intercept(Invocation invocation) throws Throwable {  </span></span>
<span class="line"><span>        return invocation.proceed();  </span></span>
<span class="line"><span>    }  </span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>    @Override  </span></span>
<span class="line"><span>    public Object plugin(Object target) {  </span></span>
<span class="line"><span>        return Plugin.wrap(target, this);  </span></span>
<span class="line"><span>    }  </span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>    @Override  </span></span>
<span class="line"><span>    public void setProperties(Properties properties) {  </span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p><strong>每一个拦截器都必须实现上面的三个方法</strong>，其中：</p><ul><li><p><code>Object intercept(Invocation invocation)</code>是实现拦截逻辑的地方，内部要通过invocation.proceed()显式地推进责任链前进，也就是调用下一个拦截器拦截目标方法。</p></li><li><p><code>Object plugin(Object target)</code> 就是用当前这个拦截器生成对目标target的代理，实际是通过Plugin.wrap(target,this)来完成的，把目标target和拦截器this传给了包装函数。</p></li><li><p><code>setProperties(Properties properties)</code>用于设置额外的参数，参数配置在拦截器的Properties节点里。</p></li></ul><blockquote><p>注解里描述的是指定拦截方法的签名 [type,method,args] （即对哪种对象的哪种方法进行拦截），它在拦截前用于决断。</p></blockquote><p>定义自己的Interceptor最重要的是要实现plugin方法和intercept方法，在plugin方法中我们可以决定是否要进行拦截进而决定要返回一个什么样的目标对象。而intercept方法就是要进行拦截的时候要执行的方法。</p><p>对于plugin方法而言，其实Mybatis已经为我们提供了一个实现。Mybatis中有一个叫做Plugin的类，里面有一个静态方法wrap(Object target,Interceptor interceptor)，通过该方法可以决定要返回的对象是目标对象还是对应的代理。这里我们先来看一下Plugin的源码：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>package org.apache.ibatis.plugin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>import java.lang.reflect.InvocationHandler;</span></span>
<span class="line"><span>import java.lang.reflect.Method;</span></span>
<span class="line"><span>import java.lang.reflect.Proxy;</span></span>
<span class="line"><span>import java.util.HashMap;</span></span>
<span class="line"><span>import java.util.HashSet;</span></span>
<span class="line"><span>import java.util.Map;</span></span>
<span class="line"><span>import java.util.Set;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>import org.apache.ibatis.reflection.ExceptionUtil;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>//这个类是Mybatis拦截器的核心,大家可以看到该类继承了InvocationHandler</span></span>
<span class="line"><span>//又是JDK动态代理机制</span></span>
<span class="line"><span>public class Plugin implements InvocationHandler {</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  //目标对象</span></span>
<span class="line"><span>  private Object target;</span></span>
<span class="line"><span>  //拦截器</span></span>
<span class="line"><span>  private Interceptor interceptor;</span></span>
<span class="line"><span>  //记录需要被拦截的类与方法</span></span>
<span class="line"><span>  private Map&lt;Class&lt;?&gt;, Set&lt;Method&gt;&gt; signatureMap;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  private Plugin(Object target, Interceptor interceptor, Map&lt;Class&lt;?&gt;, Set&lt;Method&gt;&gt; signatureMap) {</span></span>
<span class="line"><span>    this.target = target;</span></span>
<span class="line"><span>    this.interceptor = interceptor;</span></span>
<span class="line"><span>    this.signatureMap = signatureMap;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  //一个静态方法,对一个目标对象进行包装，生成代理类。</span></span>
<span class="line"><span>  public static Object wrap(Object target, Interceptor interceptor) {</span></span>
<span class="line"><span>    //首先根据interceptor上面定义的注解 获取需要拦截的信息</span></span>
<span class="line"><span>    Map&lt;Class&lt;?&gt;, Set&lt;Method&gt;&gt; signatureMap = getSignatureMap(interceptor);</span></span>
<span class="line"><span>    //目标对象的Class</span></span>
<span class="line"><span>    Class&lt;?&gt; type = target.getClass();</span></span>
<span class="line"><span>    //返回需要拦截的接口信息</span></span>
<span class="line"><span>    Class&lt;?&gt;[] interfaces = getAllInterfaces(type, signatureMap);</span></span>
<span class="line"><span>    //如果长度为&gt;0 则返回代理类 否则不做处理</span></span>
<span class="line"><span>    if (interfaces.length &gt; 0) {</span></span>
<span class="line"><span>      return Proxy.newProxyInstance(</span></span>
<span class="line"><span>          type.getClassLoader(),</span></span>
<span class="line"><span>          interfaces,</span></span>
<span class="line"><span>          new Plugin(target, interceptor, signatureMap));</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    return target;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  //代理对象每次调用的方法</span></span>
<span class="line"><span>  public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {</span></span>
<span class="line"><span>    try {</span></span>
<span class="line"><span>      //通过method参数定义的类 去signatureMap当中查询需要拦截的方法集合</span></span>
<span class="line"><span>      Set&lt;Method&gt; methods = signatureMap.get(method.getDeclaringClass());</span></span>
<span class="line"><span>      //判断是否需要拦截</span></span>
<span class="line"><span>      if (methods != null &amp;&amp; methods.contains(method)) {</span></span>
<span class="line"><span>        return interceptor.intercept(new Invocation(target, method, args));</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>      //不拦截 直接通过目标对象调用方法</span></span>
<span class="line"><span>      return method.invoke(target, args);</span></span>
<span class="line"><span>    } catch (Exception e) {</span></span>
<span class="line"><span>      throw ExceptionUtil.unwrapThrowable(e);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  //根据拦截器接口（Interceptor）实现类上面的注解获取相关信息</span></span>
<span class="line"><span>  private static Map&lt;Class&lt;?&gt;, Set&lt;Method&gt;&gt; getSignatureMap(Interceptor interceptor) {</span></span>
<span class="line"><span>    //获取注解信息</span></span>
<span class="line"><span>    Intercepts interceptsAnnotation = interceptor.getClass().getAnnotation(Intercepts.class);</span></span>
<span class="line"><span>    //为空则抛出异常</span></span>
<span class="line"><span>    if (interceptsAnnotation == null) { // issue #251</span></span>
<span class="line"><span>      throw new PluginException(&quot;No @Intercepts annotation was found in interceptor &quot; + interceptor.getClass().getName());      </span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    //获得Signature注解信息</span></span>
<span class="line"><span>    Signature[] sigs = interceptsAnnotation.value();</span></span>
<span class="line"><span>    Map&lt;Class&lt;?&gt;, Set&lt;Method&gt;&gt; signatureMap = new HashMap&lt;Class&lt;?&gt;, Set&lt;Method&gt;&gt;();</span></span>
<span class="line"><span>    //循环注解信息</span></span>
<span class="line"><span>    for (Signature sig : sigs) {</span></span>
<span class="line"><span>      //根据Signature注解定义的type信息去signatureMap当中查询需要拦截方法的集合</span></span>
<span class="line"><span>      Set&lt;Method&gt; methods = signatureMap.get(sig.type());</span></span>
<span class="line"><span>      //第一次肯定为null 就创建一个并放入signatureMap</span></span>
<span class="line"><span>      if (methods == null) {</span></span>
<span class="line"><span>        methods = new HashSet&lt;Method&gt;();</span></span>
<span class="line"><span>        signatureMap.put(sig.type(), methods);</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>      try {</span></span>
<span class="line"><span>        //找到sig.type当中定义的方法 并加入到集合</span></span>
<span class="line"><span>        Method method = sig.type().getMethod(sig.method(), sig.args());</span></span>
<span class="line"><span>        methods.add(method);</span></span>
<span class="line"><span>      } catch (NoSuchMethodException e) {</span></span>
<span class="line"><span>        throw new PluginException(&quot;Could not find method on &quot; + sig.type() + &quot; named &quot; + sig.method() + &quot;. Cause: &quot; + e, e);</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    return signatureMap;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  //根据对象类型与signatureMap获取接口信息</span></span>
<span class="line"><span>  private static Class&lt;?&gt;[] getAllInterfaces(Class&lt;?&gt; type, Map&lt;Class&lt;?&gt;, Set&lt;Method&gt;&gt; signatureMap) {</span></span>
<span class="line"><span>    Set&lt;Class&lt;?&gt;&gt; interfaces = new HashSet&lt;Class&lt;?&gt;&gt;();</span></span>
<span class="line"><span>    //循环type类型的接口信息 如果该类型存在与signatureMap当中则加入到set当中去</span></span>
<span class="line"><span>    while (type != null) {</span></span>
<span class="line"><span>      for (Class&lt;?&gt; c : type.getInterfaces()) {</span></span>
<span class="line"><span>        if (signatureMap.containsKey(c)) {</span></span>
<span class="line"><span>          interfaces.add(c);</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>      type = type.getSuperclass();</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    //转换为数组返回</span></span>
<span class="line"><span>    return interfaces.toArray(new Class&lt;?&gt;[interfaces.size()]);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>}</span></span></code></pre></div><p>下面是俩个注解类的定义源码：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>package org.apache.ibatis.plugin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>import java.lang.annotation.ElementType;</span></span>
<span class="line"><span>import java.lang.annotation.Retention;</span></span>
<span class="line"><span>import java.lang.annotation.RetentionPolicy;</span></span>
<span class="line"><span>import java.lang.annotation.Target;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>@Retention(RetentionPolicy.RUNTIME)</span></span>
<span class="line"><span>@Target(ElementType.TYPE)</span></span>
<span class="line"><span>public @interface Intercepts {</span></span>
<span class="line"><span>  Signature[] value();</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>package org.apache.ibatis.plugin;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>import java.lang.annotation.ElementType;</span></span>
<span class="line"><span>import java.lang.annotation.Retention;</span></span>
<span class="line"><span>import java.lang.annotation.RetentionPolicy;</span></span>
<span class="line"><span>import java.lang.annotation.Target;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>@Retention(RetentionPolicy.RUNTIME)</span></span>
<span class="line"><span>@Target(ElementType.TYPE)</span></span>
<span class="line"><span>public @interface Signature {</span></span>
<span class="line"><span>  Class&lt;?&gt; type();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  String method();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Class&lt;?&gt;[] args();</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="plugin-wrap方法" tabindex="-1">Plugin.wrap方法 <a class="header-anchor" href="#plugin-wrap方法" aria-label="Permalink to &quot;Plugin.wrap方法&quot;">​</a></h2><p>从前面可以看出，每个拦截器的plugin方法是通过调用Plugin.wrap方法来实现的。代码如下：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>public static Object wrap(Object target, Interceptor interceptor) {  </span></span>
<span class="line"><span>   // 从拦截器的注解中获取拦截的类名和方法信息  </span></span>
<span class="line"><span>   Map&lt;Class&lt;?&gt;, Set&lt;Method&gt;&gt; signatureMap = getSignatureMap(interceptor);  </span></span>
<span class="line"><span>   Class&lt;?&gt; type = target.getClass();  </span></span>
<span class="line"><span>   // 解析被拦截对象的所有接口（注意是接口）  </span></span>
<span class="line"><span>   Class&lt;?&gt;[] interfaces = getAllInterfaces(type, signatureMap);  </span></span>
<span class="line"><span>   if(interfaces.length &gt; 0) {  </span></span>
<span class="line"><span>        // 生成代理对象， Plugin对象为该代理对象的InvocationHandler  （InvocationHandler属于java代理的一个重要概念，不熟悉的请参考相关概念）  </span></span>
<span class="line"><span>        return Proxy.newProxyInstance(type.getClassLoader(), interfaces, new Plugin(target,interceptor,signatureMap));  </span></span>
<span class="line"><span>    }  </span></span>
<span class="line"><span>    return target;  </span></span>
<span class="line"><span>}</span></span></code></pre></div><p>这个Plugin类有三个属性：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>private Object target;// 被代理的目标类</span></span>
<span class="line"><span></span></span>
<span class="line"><span>private Interceptor interceptor;// 对应的拦截器</span></span>
<span class="line"><span></span></span>
<span class="line"><span>private Map&lt;Class&lt;?&gt;, Set&lt;Method&gt;&gt; signatureMap;// 拦截器拦截的方法缓存</span></span></code></pre></div><p><strong>getSignatureMap方法</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>private static Map&lt;Class&lt;?&gt;, Set&lt;Method&gt;&gt; getSignatureMap(Interceptor interceptor) {</span></span>
<span class="line"><span>    Intercepts interceptsAnnotation = interceptor.getClass().getAnnotation(Intercepts.class);</span></span>
<span class="line"><span>    if (interceptsAnnotation == null) { // issue #251</span></span>
<span class="line"><span>      throw new PluginException(&quot;No @Intercepts annotation was found in interceptor &quot; + interceptor.getClass().getName());      </span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    Signature[] sigs = interceptsAnnotation.value();</span></span>
<span class="line"><span>    Map&lt;Class&lt;?&gt;, Set&lt;Method&gt;&gt; signatureMap = new HashMap&lt;Class&lt;?&gt;, Set&lt;Method&gt;&gt;();</span></span>
<span class="line"><span>    for (Signature sig : sigs) {</span></span>
<span class="line"><span>      Set&lt;Method&gt; methods = signatureMap.get(sig.type());</span></span>
<span class="line"><span>      if (methods == null) {</span></span>
<span class="line"><span>        methods = new HashSet&lt;Method&gt;();</span></span>
<span class="line"><span>        signatureMap.put(sig.type(), methods);</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>      try {</span></span>
<span class="line"><span>        Method method = sig.type().getMethod(sig.method(), sig.args());</span></span>
<span class="line"><span>        methods.add(method);</span></span>
<span class="line"><span>      } catch (NoSuchMethodException e) {</span></span>
<span class="line"><span>        throw new PluginException(&quot;Could not find method on &quot; + sig.type() + &quot; named &quot; + sig.method() + &quot;. Cause: &quot; + e, e);</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    return signatureMap;</span></span>
<span class="line"><span>}</span></span></code></pre></div><p><strong>getSignatureMap方法解释</strong>：首先会拿到拦截器这个类的 @Interceptors注解，然后拿到这个注解的属性 @Signature注解集合，然后遍历这个集合，遍历的时候拿出 @Signature注解的type属性(Class类型)，然后根据这个type得到带有method属性和args属性的Method。由于 @Interceptors注解的 @Signature属性是一个属性，所以最终会返回一个以type为key，value为<code>Set&lt;Method&gt;</code>的Map。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>@Intercepts({@Signature(type= Executor.class, method = &quot;update&quot;, args = {MappedStatement.class,Object.class})})</span></span></code></pre></div><p>比如这个 @Interceptors注解会返回一个key为Executor，value为集合(这个集合只有一个元素，也就是Method实例，这个Method实例就是Executor接口的update方法，且这个方法带有MappedStatement和Object类型的参数)。这个Method实例是根据 @Signature的method和args属性得到的。如果args参数跟type类型的method方法对应不上，那么将会抛出异常。</p><p><strong>getAllInterfaces方法</strong>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>private static Class&lt;?&gt;[] getAllInterfaces(Class&lt;?&gt; type, Map&lt;Class&lt;?&gt;, Set&lt;Method&gt;&gt; signatureMap) {</span></span>
<span class="line"><span>    Set&lt;Class&lt;?&gt;&gt; interfaces = new HashSet&lt;Class&lt;?&gt;&gt;();</span></span>
<span class="line"><span>    while (type != null) {</span></span>
<span class="line"><span>      for (Class&lt;?&gt; c : type.getInterfaces()) {</span></span>
<span class="line"><span>        if (signatureMap.containsKey(c)) {</span></span>
<span class="line"><span>          interfaces.add(c);</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>      }</span></span>
<span class="line"><span>      type = type.getSuperclass();</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    return interfaces.toArray(new Class&lt;?&gt;[interfaces.size()]);</span></span>
<span class="line"><span>}</span></span></code></pre></div><p><strong>getAllInterfaces方法解释</strong>： 根据目标实例target(这个target就是之前所说的MyBatis拦截器可以拦截的类，Executor,ParameterHandler,ResultSetHandler,StatementHandler)和它的父类们，返回signatureMap中含有target实现的接口数组。</p><p>所以Plugin这个类的作用就是根据 @Interceptors注解，得到这个注解的属性 @Signature数组，然后根据每个 @Signature注解的type，method，args属性使用反射找到对应的Method。最终根据调用的target对象实现的接口决定是否返回一个代理对象替代原先的target对象。</p><p>我们再次结合(Executor)interceptorChain.pluginAll(executor)这个语句来看，这个语句内部对executor执行了多次plugin,第一次plugin后通过Plugin.wrap方法生成了第一个代理类，姑且就叫executorProxy1，这个代理类的target属性是该executor对象。第二次plugin后通过Plugin.wrap方法生成了第二个代理类，姑且叫executorProxy2，这个代理类的target属性是executorProxy1...这样通过每个代理类的target属性就构成了一个代理链（从最后一个executorProxyN往前查找，通过target属性可以找到最原始的executor类）。</p><h2 id="代理链上的拦截" tabindex="-1">代理链上的拦截 <a class="header-anchor" href="#代理链上的拦截" aria-label="Permalink to &quot;代理链上的拦截&quot;">​</a></h2><blockquote><p>代理链生成后，对原始目标的方法调用都转移到代理者的invoke方法上来了。Plugin作为InvocationHandler的实现类，他的invoke方法是怎么样的呢？</p></blockquote><p>比如MyBatis官网的例子，当Configuration调用newExecutor方法的时候，由于Executor接口的update(MappedStatement ms, Object parameter)方法被拦截器被截获。因此最终返回的是一个代理类Plugin，而不是Executor。这样调用方法的时候，如果是个代理类，那么会执行：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {  </span></span>
<span class="line"><span>    try {  </span></span>
<span class="line"><span>       Set&lt;Method&gt; methods = signatureMap.get(method.getDeclaringClass());  </span></span>
<span class="line"><span>        if(methods != null &amp;&amp; methods.contains(method)) {  </span></span>
<span class="line"><span>           // 调用代理类所属拦截器的intercept方法，  </span></span>
<span class="line"><span>           return interceptor.intercept(new Invocation(target, method, args));  </span></span>
<span class="line"><span>        }  </span></span>
<span class="line"><span>        return method.invoke(target, args);  </span></span>
<span class="line"><span>    } catch(Exception e) {  </span></span>
<span class="line"><span>        throw ExceptionUtil.unwrapThrowable(e);  </span></span>
<span class="line"><span>    }  </span></span>
<span class="line"><span>}</span></span></code></pre></div><p>没错，如果找到对应的方法被代理之后，那么会执行Interceptor接口的interceptor方法。</p><p>在invoke里，如果方法签名和拦截中的签名一致，就调用拦截器的拦截方法。我们看到传递给拦截器的是一个Invocation对象，这个对象是什么样子的，他的功能又是什么呢？</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>public class Invocation {  </span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>    private Object target;  </span></span>
<span class="line"><span>    private Method method;  </span></span>
<span class="line"><span>    private Object[] args;  </span></span>
<span class="line"><span>   </span></span>
<span class="line"><span>    public Invocation(Object target, Method method, Object[] args) {  </span></span>
<span class="line"><span>        this.target =target;  </span></span>
<span class="line"><span>        this.method =method;  </span></span>
<span class="line"><span>        this.args =args;  </span></span>
<span class="line"><span>    }  </span></span>
<span class="line"><span>    ...  </span></span>
<span class="line"><span>  </span></span>
<span class="line"><span>    public Object proceed() throws InvocationTargetException, IllegalAccessException {  </span></span>
<span class="line"><span>        return method.invoke(target, args);  </span></span>
<span class="line"><span>    }  </span></span>
<span class="line"><span>}</span></span></code></pre></div><p>可以看到，Invocation类保存了代理对象的目标类，执行的目标类方法以及传递给它的参数。</p><p>在每个拦截器的intercept方法内，最后一个语句一定是return invocation.proceed()（不这么做的话拦截器链就断了，你的mybatis基本上就不能正常工作了）。invocation.proceed()只是简单的调用了下target的对应方法，如果target还是个代理，就又回到了上面的Plugin.invoke方法了。这样就形成了拦截器的调用链推进。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>public Object intercept(Invocation invocation) throws Throwable {  </span></span>
<span class="line"><span>    //完成代理类本身的逻辑  </span></span>
<span class="line"><span>    ...</span></span>
<span class="line"><span>    //通过invocation.proceed()方法完成调用链的推进</span></span>
<span class="line"><span>    return invocation.proceed();</span></span>
<span class="line"><span>}</span></span></code></pre></div><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>MyBatis拦截器接口提供的3个方法中，plugin方法用于某些处理器(Handler)的构建过程。interceptor方法用于处理代理类的执行。setProperties方法用于拦截器属性的设置。</p><p>其实MyBatis官网提供的使用 @Interceptors和 @Signature注解以及Plugin类这样处理拦截器的方法，我们不一定要直接这样使用。我们也可以抛弃这3个类，直接在plugin方法内部根据target实例的类型做相应的操作。</p><p>总体来说MyBatis拦截器还是很简单的，拦截器本身不需要太多的知识点，但是学习拦截器需要对MyBatis中的各个接口很熟悉，因为拦截器涉及到了各个接口的知识点。</p><p>我们假设在MyBatis配置了一个插件，在运行时会发生什么？</p><ul><li>所有可能被拦截的处理类都会生成一个代理</li><li>处理类代理在执行对应方法时，判断要不要执行插件中的拦截方法</li><li>执行插接中的拦截方法后，推进目标的执行</li><li>如果有N个插件，就有N个代理，每个代理都要执行上面的逻辑。这里面的层层代理要多次生成动态代理，是比较影响性能的。虽然能指定插件拦截的位置，但这个是在执行方法时动态判断，初始化的时候就是简单的把插件包装到了所有可以拦截的地方。</li></ul><p>因此，在<strong>编写插件时需注意以下几个原则</strong>：</p><ul><li>不编写不必要的插件；</li><li>实现plugin方法时判断一下目标类型，是本插件要拦截的对象才执行Plugin.wrap方法，否者直接返回目标本省，这样可以减少目标被代理的次数。</li></ul><p>本文转自 <a href="https://pdai.tech" target="_blank" rel="noreferrer">https://pdai.tech</a>，如有侵权，请联系删除。</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--[--><!--[--><!--[--><div style="" class="vitepress-backTop-main" title="返回顶部" data-v-69be28d1><svg t="1720595052079" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4279" width="200" height="200" data-v-69be28d1><path d="M752.736 431.063C757.159 140.575 520.41 8.97 504.518 0.41V0l-0.45 0.205-0.41-0.205v0.41c-15.934 8.56-252.723 140.165-248.259 430.653-48.21 31.457-98.713 87.368-90.685 184.074 8.028 96.666 101.007 160.768 136.601 157.287 35.595-3.482 25.232-30.31 25.232-30.31l12.206-50.095s52.47 80.569 69.304 80.528c15.114-1.23 87-0.123 95.6 0h0.82c8.602-0.123 80.486-1.23 95.6 0 16.794 0 69.305-80.528 69.305-80.528l12.165 50.094s-10.322 26.83 25.272 30.31c35.595 3.482 128.574-60.62 136.602-157.286 8.028-96.665-42.475-152.617-90.685-184.074z m-248.669-4.26c-6.758-0.123-94.781-3.359-102.891-107.192 2.95-98.714 95.97-107.438 102.891-107.93 6.964 0.492 99.943 9.216 102.892 107.93-8.11 103.833-96.174 107.07-102.892 107.192z m-52.019 500.531c0 11.838-9.42 21.382-21.012 21.382a21.217 21.217 0 0 1-21.054-21.34V821.74c0-11.797 9.421-21.382 21.054-21.382 11.591 0 21.012 9.585 21.012 21.382v105.635z m77.333 57.222a21.504 21.504 0 0 1-21.34 21.626 21.504 21.504 0 0 1-21.34-21.626V827.474c0-11.96 9.543-21.668 21.299-21.668 11.796 0 21.38 9.708 21.38 21.668v157.082z m71.147-82.043c0 11.796-9.42 21.34-21.053 21.34a21.217 21.217 0 0 1-21.013-21.34v-75.367c0-11.755 9.421-21.299 21.013-21.299 11.632 0 21.053 9.544 21.053 21.3v75.366z" fill="#FFF" p-id="4280" data-v-69be28d1></path></svg></div><!--]--><!--]--><!--]--><!--]--><div class="edit-info" data-v-e257564d><!----><div class="last-updated" data-v-e257564d><p class="VPLastUpdated" data-v-e257564d data-v-e98dd255>最后更新于: <time datetime="2025-01-24T08:12:26.000Z" data-v-e98dd255></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-dynamic-sql" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>上一页</span><span class="title" data-v-e257564d> MyBatis详解 - 动态SQL使用与原理 </span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/vitepress-blog-template/framework/orm-mybatis/mybatis-y-plugin-page" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>下一页</span><span class="title" data-v-e257564d> MyBatis详解 - 插件之分页机制 </span><!--]--></a></div></nav></footer><!--[--><!--[--><!--[--><div style="margin-top:24px;"><!----></div><!--]--><!--]--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5d98c3a5 data-v-e315a0ad><div class="container" data-v-e315a0ad><p class="message" data-v-e315a0ad>Released under the MIT License.</p><p class="copyright" data-v-e315a0ad>Copyright © 2024-2025 lz</p></div></footer><!--[--><!--]--></div></div>
    
    
  </body>
</html>